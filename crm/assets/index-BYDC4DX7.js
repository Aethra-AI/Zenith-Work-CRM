import{c as W,g as S,r as c,s as m,H as te,J as ie,K as f,_ as u,P as L,u as k,N as se,d as j,Q as re,j as o,e as v,f as M,R as ne,T as q,S as z,h as b,b as y,C as O,B as A,I as le,m as ce}from"./index-DwgVNSjU.js";import{a as Y}from"./api-iZ8k4Gbm.js";import{A as H}from"./Alert-CyucHNpI.js";import{D as de}from"./DataGrid-v1UXNo7h.js";import{C as pe}from"./Chip-D8aj79A0.js";import"./FormControlLabel-tAHDAUQc.js";import"./TableCell-PUvZnxu2.js";function ue(e){return S("MuiDialog",e)}const _=W("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),K=c.createContext({}),ge=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],xe=m(te,{name:"MuiDialog",slot:"Backdrop",overrides:(e,a)=>a.backdrop})({zIndex:-1}),me=e=>{const{classes:a,scroll:t,maxWidth:i,fullWidth:r,fullScreen:n}=e,p={root:["root"],container:["container",`scroll${f(t)}`],paper:["paper",`paperScroll${f(t)}`,`paperWidth${f(String(i))}`,r&&"paperFullWidth",n&&"paperFullScreen"]};return M(p,ue,a)},he=m(ie,{name:"MuiDialog",slot:"Root",overridesResolver:(e,a)=>a.root})({"@media print":{position:"absolute !important"}}),fe=m("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.container,a[`scroll${f(t.scroll)}`]]}})(({ownerState:e})=>u({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),ve=m(L,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.paper,a[`scrollPaper${f(t.scroll)}`],a[`paperWidth${f(String(t.maxWidth))}`],t.fullWidth&&a.paperFullWidth,t.fullScreen&&a.paperFullScreen]}})(({theme:e,ownerState:a})=>u({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},a.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},a.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!a.maxWidth&&{maxWidth:"calc(100% - 64px)"},a.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${_.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},a.maxWidth&&a.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[a.maxWidth]}${e.breakpoints.unit}`,[`&.${_.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[a.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},a.fullWidth&&{width:"calc(100% - 64px)"},a.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${_.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Ce=c.forwardRef(function(a,t){const i=k({props:a,name:"MuiDialog"}),r=se(),n={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{"aria-describedby":p,"aria-labelledby":l,BackdropComponent:d,BackdropProps:g,children:C,className:s,disableEscapeKeyDown:x=!1,fullScreen:w=!1,fullWidth:P=!1,maxWidth:R="sm",onBackdropClick:F,onClick:I,onClose:N,open:E,PaperComponent:X=L,PaperProps:U={},scroll:G="paper",TransitionComponent:J=ne,transitionDuration:V=n,TransitionProps:Q}=i,Z=j(i,ge),D=u({},i,{disableEscapeKeyDown:x,fullScreen:w,fullWidth:P,maxWidth:R,scroll:G}),T=me(D),$=c.useRef(),ee=h=>{$.current=h.target===h.currentTarget},ae=h=>{I&&I(h),$.current&&($.current=null,F&&F(h),N&&N(h,"backdropClick"))},B=re(l),oe=c.useMemo(()=>({titleId:B}),[B]);return o.jsx(he,u({className:v(T.root,s),closeAfterTransition:!0,components:{Backdrop:xe},componentsProps:{backdrop:u({transitionDuration:V,as:d},g)},disableEscapeKeyDown:x,onClose:N,open:E,ref:t,onClick:ae,ownerState:D},Z,{children:o.jsx(J,u({appear:!0,in:E,timeout:V,role:"presentation"},Q,{children:o.jsx(fe,{className:v(T.container),onMouseDown:ee,ownerState:D,children:o.jsx(ve,u({as:X,elevation:24,role:"dialog","aria-describedby":p,"aria-labelledby":B},U,{className:v(T.paper,U.className),ownerState:D,children:o.jsx(K.Provider,{value:oe,children:C})}))})}))}))});function be(e){return S("MuiDialogActions",e)}W("MuiDialogActions",["root","spacing"]);const De=["className","disableSpacing"],ye=e=>{const{classes:a,disableSpacing:t}=e;return M({root:["root",!t&&"spacing"]},be,a)},We=m("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,!t.disableSpacing&&a.spacing]}})(({ownerState:e})=>u({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Se=c.forwardRef(function(a,t){const i=k({props:a,name:"MuiDialogActions"}),{className:r,disableSpacing:n=!1}=i,p=j(i,De),l=u({},i,{disableSpacing:n}),d=ye(l);return o.jsx(We,u({className:v(d.root,r),ownerState:l,ref:t},p))});function ke(e){return S("MuiDialogContent",e)}W("MuiDialogContent",["root","dividers"]);function je(e){return S("MuiDialogTitle",e)}const Me=W("MuiDialogTitle",["root"]),we=["className","dividers"],Pe=e=>{const{classes:a,dividers:t}=e;return M({root:["root",t&&"dividers"]},ke,a)},Re=m("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:t}=e;return[a.root,t.dividers&&a.dividers]}})(({theme:e,ownerState:a})=>u({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},a.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Me.root} + &`]:{paddingTop:0}})),Ne=c.forwardRef(function(a,t){const i=k({props:a,name:"MuiDialogContent"}),{className:r,dividers:n=!1}=i,p=j(i,we),l=u({},i,{dividers:n}),d=Pe(l);return o.jsx(Re,u({className:v(d.root,r),ownerState:l,ref:t},p))}),Te=["className","id"],$e=e=>{const{classes:a}=e;return M({root:["root"]},je,a)},Be=m(q,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,a)=>a.root})({padding:"16px 24px",flex:"0 0 auto"}),Ae=c.forwardRef(function(a,t){const i=k({props:a,name:"MuiDialogTitle"}),{className:r,id:n}=i,p=j(i,Te),l=i,d=$e(l),{titleId:g=n}=c.useContext(K);return o.jsx(Be,u({component:"h2",className:v(d.root,r),ownerState:l,ref:t,variant:"h6",id:n??g},p))}),_e=({open:e,onClose:a,onSuccess:t})=>{const[i,r]=c.useState({cargo_solicitado:"",descripcion:"",requisitos:"",salario:"",ciudad:""}),[n,p]=c.useState(!1),[l,d]=c.useState(null),g=x=>{const{name:w,value:P}=x.target;r(R=>({...R,[w]:P}))},C=async()=>{if(!i.cargo_solicitado||!i.descripcion){d("El cargo solicitado y la descripción son obligatorios.");return}p(!0),d(null);try{await Y.post("/vacancies",i),t(),s()}catch(x){console.error("Error al crear la vacante:",x),d("No se pudo crear la vacante. Por favor, inténtelo de nuevo.")}finally{p(!1)}},s=()=>{r({cargo_solicitado:"",descripcion:"",requisitos:"",salario:"",ciudad:""}),d(null),a()};return o.jsxs(Ce,{open:e,onClose:s,fullWidth:!0,maxWidth:"sm",children:[o.jsx(Ae,{children:"Crear Nueva Vacante"}),o.jsx(Ne,{children:o.jsxs(z,{spacing:2,sx:{mt:2},children:[l&&o.jsx(H,{severity:"error",children:l}),o.jsx(b,{required:!0,autoFocus:!0,margin:"dense",name:"cargo_solicitado",label:"Cargo Solicitado",type:"text",fullWidth:!0,variant:"outlined",value:i.cargo_solicitado,onChange:g}),o.jsx(b,{required:!0,margin:"dense",name:"descripcion",label:"Descripción del Puesto",type:"text",fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:i.descripcion,onChange:g}),o.jsx(b,{margin:"dense",name:"requisitos",label:"Requisitos",type:"text",fullWidth:!0,multiline:!0,rows:3,variant:"outlined",value:i.requisitos,onChange:g}),o.jsx(b,{margin:"dense",name:"salario",label:"Salario Ofrecido",type:"text",fullWidth:!0,variant:"outlined",value:i.salario,onChange:g}),o.jsx(b,{margin:"dense",name:"ciudad",label:"Ciudad",type:"text",fullWidth:!0,variant:"outlined",value:i.ciudad,onChange:g})]})}),o.jsxs(Se,{sx:{p:"16px 24px"},children:[o.jsx(y,{onClick:s,children:"Cancelar"}),o.jsx(y,{onClick:C,variant:"contained",disabled:n,children:n?o.jsx(O,{size:24}):"Crear Vacante"})]})]})},ze=()=>{const[e,a]=c.useState([]),[t,i]=c.useState(!0),[r,n]=c.useState(null),[p,l]=c.useState(!1),d=async()=>{i(!0),n(null);try{const s=await Y.get("/vacancies");a(s.data)}catch(s){console.error("Error al obtener las vacantes:",s),n("No se pudieron cargar las vacantes. Por favor, recargue la página.")}finally{i(!1)}};c.useEffect(()=>{d()},[]);const g=[{field:"cargo_solicitado",headerName:"Cargo",flex:2,minWidth:200},{field:"postulaciones_count",headerName:"Postulaciones",flex:1,minWidth:120,align:"center",headerAlign:"center"},{field:"estado",headerName:"Estado",flex:1,minWidth:120,renderCell:s=>{const x={Abierta:"success",Cerrada:"default",Pausada:"warning"};return o.jsx(pe,{label:s.value,color:x[s.value]||"default",size:"small"})}},{field:"fecha_creacion",headerName:"Fecha de Creación",flex:1,minWidth:150,valueFormatter:s=>new Date(s.value).toLocaleDateString()},{field:"actions",headerName:"Acciones",flex:1,minWidth:150,sortable:!1,renderCell:s=>o.jsx(y,{variant:"outlined",size:"small",component:ce,to:`/CRM/vacancies/${s.row.id_vacante}/pipeline`,children:"Ver Pipeline"})}],C=()=>{d()};return o.jsxs(A,{p:3.5,children:[o.jsxs(z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:3,children:[o.jsx(q,{variant:"h4",children:"Gestión de Vacantes"}),o.jsx(y,{variant:"contained",startIcon:o.jsx(le,{icon:"mdi:plus"}),onClick:()=>l(!0),children:"Nueva Vacante"})]}),t&&o.jsx(A,{display:"flex",justifyContent:"center",mt:5,children:o.jsx(O,{})}),r&&o.jsx(H,{severity:"error",sx:{mt:2},children:r}),!t&&!r&&o.jsx(A,{sx:{height:600,width:"100%"},children:o.jsx(de,{rows:e,columns:g,getRowId:s=>s.id_vacante,initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[5,10,20],checkboxSelection:!0,disableRowSelectionOnClick:!0})}),o.jsx(_e,{open:p,onClose:()=>l(!1),onSuccess:C})]})};export{ze as default};
